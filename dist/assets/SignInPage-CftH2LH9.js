import{r as N,S as C,o as F,j as e,w as P,B as t,C as y,L as H}from"./index-NFrXaa-t.js";import{P as E}from"./PageWrapper-CZeAlEoX.js";import{z as r,u as v,F as d,t as B}from"./index-Cen63i1p.js";import{C as L}from"./CustomButton-K3qDH9e9.js";import{H as V}from"./HiddenPasswordButton-DWsdL-dM.js";import{a as k}from"./AuthService-D1szSgLp.js";const A=r.object({email:r.string().min(1,"Пожалуйста, заполните обязательное поле").refine(s=>!(s!=null&&s.includes(" ")),"В данном поле не должно быть пробелов"),password:r.string().min(1,"Пожалуйста, заполните обязательное поле").refine(s=>!(s!=null&&s.includes(" ")),"В данном поле не должно быть пробелов")}),D=()=>{var o,l;const[s,m]=N.useState(!0),c=C(),p=F(),[u]=k.useLoginMutation({fixedCacheKey:"shared-update-post"}),{register:i,handleSubmit:x,formState:{errors:n,isSubmitting:h,isDirty:g,isValid:f},reset:j,setValue:b}=v({resolver:B(A),mode:"onChange"}),w=async I=>{await u(I).unwrap().then(({user:a,token:S})=>{localStorage.setItem("token",S),c(P(a)),j(),p("/",{replace:!0}),t.success("Вход выполнен успешно!")}).catch(a=>{a.data?t.error(a.data.message):t.error("Ошибка сервера! Пожалуйста, повторите попытку позже.")})};return e.jsxs("form",{onSubmit:x(w),className:"mx-auto max-w-96",children:[e.jsxs("fieldset",{className:"mx-auto mb-5 flex flex-col gap-3 w-full",children:[e.jsx(d,{labelTitle:"Email*",inputId:"Email",error:(o=n.email)==null?void 0:o.message,placeholder:"Введите email",...i("email"),clearField:()=>b("email","",{shouldValidate:!0})}),e.jsx(d,{labelTitle:"Пароль*",inputId:"Пароль",type:s?"password":"text",error:(l=n.password)==null?void 0:l.message,placeholder:"Введите пароль",...i("password"),children:e.jsx(V,{hidden:s,setHidden:()=>m(!s)})})]}),e.jsx("p",{className:"mb-3",children:"* - обязательные поля для заполнения"}),e.jsx(L,{disabled:h||!g||!f,children:e.jsx("span",{children:"Войти"})})]})},W=()=>e.jsx(E,{children:e.jsx("section",{className:"pt-8 pb-36",children:e.jsxs(y,{children:[e.jsx("h2",{className:"text-center text-2xl mb-5 font-semibold",children:"Добро пожаловать в Male Fashion"}),e.jsxs("p",{className:"text-center mb-8",children:["Впервые здесь?"," ",e.jsx(H,{to:"/signup",className:"underline py-3",children:"Зарегистрироваться"})]}),e.jsx(D,{})]})})});export{W as default};
